CREATE PROC udp_ChildStatusUpdateIssue(
    @iTransId bigint,
    @iUSerId int = 0
)
AS
BEGIN

    SET @iTransId = dbo.fCrm_IntToAPITransId(@iTransId, 0);


    DECLARE @ComponentId int;


    DECLARE cur CURSOR FOR
    SELECT ComponentAssetID FROM muCore_ComponentPartIssuetoParentID_PartIssueDetails_Details WHERE iMasterId = @iTransId;


    OPEN cur;


    FETCH NEXT FROM cur INTO @ComponentId;

    WHILE @@FETCH_STATUS = 0
    BEGIN

        UPDATE vCore_ComponentAssetRegister SET ChildAssetStatus = 2 WHERE iMasterId = @ComponentId;

        FETCH NEXT FROM cur INTO @ComponentId;
    END;


    CLOSE cur;
    DEALLOCATE cur;
END;
