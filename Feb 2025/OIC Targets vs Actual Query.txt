select *,(a.TargetQuantity-a.Achievement) Balance,CAST(CASE WHEN  TargetQuantity=0.00 or Achievement=0.00 then  0.00 else ((TargetQuantity/Achievement)*100)   end as DECIMAL(18,2)) [Percentage],a.[YearName],a.[MonthName] from 
(
select 'Target' [Type],b.sName [Sales Person],c.sName [Year],d.sName [Product],e.sName[Month],a.TargetQuantity,0.00 [Achievement],0 [iDate],a.[Product] ProdId,
a.[Year] [YearName],a.[MonthName] from vuCore_Targets_Info_Details a with(nolock)
left join vCore_SalesPersons b with(nolock) on a.SalesPerson=b.iMasterId
left join vCore_YearMaster c with(nolock) on a.[Year]=c.iMasterId
left join vCore_Product d with(nolock) on a.Product=d.iMasterId
left join vCore_MonthName e with(nolock) on a.[MonthName]=e.iMasterId
where a.iMasterId>0 
union all
select 'Achievement',b.sName,DATENAME(YYYY,dbo.fCore_IntToDate(a.iDate)),c.sName,DATENAME(MM,dbo.fCore_IntToDate(a.iDate)),0.00,fNet,a.iDate,a.iProductId,0,0 from vuCrm_FSalesInvoices_General_Details a with(nolock)
left join vCrm_Users b with(nolock) on a.iAssignedTo=b.iMasterId
left join  vCore_Product c with(nolock) on a.iProductId=c.iMasterId
where a.iTransId>0 
)a
where iDate between @STARTDATE and @ENDDATE
and  (( 0 in (@Product) and isnull(ProdId,0)  = isnull(ProdId,0) ) or (0 not in (@Product) and isnull(ProdId,0)   in ( @Product )))
and  (( 0 in (@Year) and isnull([Year],0)  = isnull([Year],0) ) or (0 not in (@Year) and isnull([Year],0)   in ( @Year )))
and  (( 0 in (@Month) and isnull([MonthName],0)  = isnull([MonthName],0) ) or (0 not in (@Month) and isnull([MonthName],0)   in ( @Month )))